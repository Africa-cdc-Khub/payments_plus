# Disable directory browsing
Options -Indexes

# Prevent access to sensitive files
<FilesMatch "\.(env|ini|conf|log|sql|md|txt|json|lock|key|pem|crt)$">
    Require all denied
</FilesMatch>

# Protect database connector (but allow bootstrap and functions for includes)
<Files "db_connector.php">
    Require all denied
</Files>

# Protect test and debug files
<FilesMatch "^(test_|debug_|check_).*\.php$">
    Require all denied
</FilesMatch>

# Protect migration and setup files
<FilesMatch "^(migrations|setup|install|run_migrations).*\.php$">
    Require all denied
</FilesMatch>

# Protect vendor directory
<Directory "vendor">
    Require all denied
</Directory>

# Protect composer files
<Files "composer.*">
    Require all denied
</Files>

# Prevent access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>